---
- name: add sublime-text repo to pacman.conf
  ansible.builtin.blockinfile:
    path: /etc/pacman.conf
    block: |
      [sublime-text]
      Server = https://download.sublimetext.com/arch/stable/x86_64
  notify: refresh pacman

- name: Flush handlers
  meta: flush_handlers

- name: install sublime gpg key
  shell:
    cmd: pacman-key -a
    stdin: '{{ sublime_gpg_key }}'

- name: trust sublime gpg key
  shell: pacman-key --lsign-key 8A8F901A

- name: install sublime-text
  community.general.pacman:
    name: sublime-text
